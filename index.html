<!DOCTYPE HTML>
<!--
SImple line making tool to make it easier for speed graphs and stuff

Eric Lemieux, 2014
-->
<html>
	<head>
		<title>Line Plotter</title>
	</head>
	
	<body>
		<div>
			<canvas id="canv" width="750" height="750" style="border:1px solid #000000;"></canvas>
			
			<div style="text-align:left;">
				<h2>Line Plotter thing</h2>
				<button onClick="saveToFile()">Save as JSON</button>
				<a id="download" href=""></a>
			</div>
			
			<div id="results">
			
			</div>
		</div>
		
		<script>
			var c = document.getElementById("canv");
			c.addEventListener("mousedown", doMouseDown, false);
			var ctx = c.getContext("2d");
			ctx.fillStyle = "#000000";
			
			var pointList = []
			pointList.push([0.0,750.0]);
			
			function doMouseDown(event){
				//Get the location of the click
				var x = event.pageX;
				var y = event.pageY;
				
				//Append the array with the new data
				pointList.push([x,y]);
				
				//Draw onto the canvas
				ctx.fillRect(pointList[pointList.length-1][0], pointList[pointList.length-1][1], 5, 5);
				
				//Draw the connecting line
				if(pointList.length >= 2){
					ctx.moveTo(pointList[pointList.length-2][0], pointList[pointList.length-2][1]);
					ctx.lineTo(pointList[pointList.length-1][0], pointList[pointList.length-1][1]);
					ctx.stroke();
				}
			}
			
			function saveToFile(){
				//Normalize the points data
				for(var i = 0;  i < pointList.length; ++i){
					pointList[i][0] = pointList[i][0] / 750.0;
					pointList[i][1] = pointList[i][1] / 750.0;
					
					//Flip the y-axis
					pointList[i][1] = 1.0 - pointList[i][1];
				}
			
				var myBlob = new Blob([JSON.stringify(pointList)], {type: 'application/json'});
				
				var a = document.getElementById("download");
				a.href = URL.createObjectURL(myBlob);
				a.download = 'filename.json';
				a.textContent = 'Download file! (Right click and save as)';
			}
		</script>
	</body>
</html>